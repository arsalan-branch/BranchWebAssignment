<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Branch Web SDK Demo</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Branch Web SDK Integration</h1>
    <button id="branch-link">Create Branch Link</button>
    <h2>Branch Quick Link Reader</h2>
    <div class="data-box" id="quick-link-data">
        Loading Branch link data...
    </div>

    <script>
        // Load Branch Web SDK
                 (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener banner closeBanner closeJourney data deepview deepviewCta first init link logout removeListener setBranchViewData setIdentity track trackCommerceEvent logEvent disableTracking getBrowserFingerprintId crossPlatformIds lastAttributedTouchData setAPIResponseCallback qrCode setRequestMetaData setAPIUrl getAPIUrl setDMAParamsForEEA".split(" "), 0);

        // Initialize Branch
        branch.init('key_live_jAozxBAhXn9NYeOS8Vj8BefnDxdempwR', function(err, data) {
            if (err) {
                console.error('Branch initialization failed:', err);
            } else {
                console.log('Branch initialized:', data);

                // Check if the Branch link data is available
                if (data && data['+clicked_branch_link']) {
                    // Successfully retrieved the data from a Branch link
                    document.getElementById('quick-link-data').innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                    console.log('Branch link data:', data);
                } else {
                    // No Branch link data available
                    document.getElementById('quick-link-data').innerText = 'No Branch link data found.';
                    console.log('No Branch link data found.');
                }
            }
        });

        // Example: Create a Branch link on button click
        document.getElementById('branch-link').addEventListener('click', function() {
            branch.link({
                tags: ['tag1', 'tag2'],
                channel: 'website',
                feature: 'create-link',
                stage: 'new user',
                data: {
                    mydata: 'something',
                    foo: 'bar',
                    '$desktop_url': 'https://example.com',
                    '$ios_url': 'https://example.com/ios',
                    '$android_url': 'https://example.com/android'
                }
            }, function(err, link) {
                if (err) {
                    console.error('Failed to create link:', err);
                } else {
                    console.log('Branch link created:', link);
                    alert('Branch link created: ' + link);
                }
            });
        });
    </script>
</body>
</html>
